<!DOCTYPE html>
<html>
<head>
    <title>ox_target - Developer Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" />
    <link href="style.css" rel="stylesheet" type="text/css" />
    <style>
        body {
            background: #1a1a1a;
            color: white;
            font-family: Arial, sans-serif;
        }
        
        .dev-info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            max-width: 300px;
        }
        
        .dev-controls {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
        }
        
        .dev-controls button {
            background: #333;
            color: white;
            border: 1px solid #555;
            padding: 8px 12px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .dev-controls button:hover {
            background: #444;
        }
        
        .dev-controls button.active {
            background: #0066cc;
        }
        
        .side-demo {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 12px;
            text-align: center;
        }
        
        .side-demo .left-side {
            color: #ff6b6b;
            display: inline-block;
            margin-right: 20px;
        }
        
        .side-demo .right-side {
            color: #4ecdc4;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="dev-info">
        <h3>ox_target Developer Mode</h3>
        <p><strong>Controls:</strong></p>
        <ul>
            <li>Press 'E' to toggle targeting</li>
            <li>Click options to test functionality</li>
            <li>Options with arrows (→ or ←) have submenus</li>
            <li>Click outside submenu to close it</li>
        </ul>
        <p><strong>Features:</strong></p>
        <ul>
            <li><span style="color: #ff6b6b;">Left side</span> and <span style="color: #4ecdc4;">right side</span> positioning</li>
            <li>Nested submenus with proper positioning</li>
            <li>Smooth animations and transitions</li>
            <li>Click outside to close submenus</li>
        </ul>
    </div>
    
    <div class="dev-controls">
        <h4>Test Controls</h4>
        <button onclick="addLeftOption()">Add Left Option</button>
        <button onclick="addRightOption()">Add Right Option</button>
        <button onclick="clearOptions()">Clear Options</button>
        <button onclick="toggleComplexMenu()">Toggle Complex Menu</button>
    </div>
    
    <div class="side-demo">
        <div class="left-side">← Left Side: Settings, Vehicle, Shop</div>
        <div class="right-side">Right Side: Interact, Player, Repair, Enter →</div>
    </div>

    <div id="eye">
        <svg id="eyeSvg" xmlns="http://www.w3.org/2000/svg" height="36px" viewBox="0 0 24 24" width="36px" fill="#000000">
            <path d="M0 0h24v24H0V0z" fill="none"/>
            <path d="M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
        </svg>
    </div>
    <div id="options-wrapper"></div>

    <script type="module">
        import { createOptions, closeCurrentSubmenu } from "./js/createOptions.js";

        // Mock GetParentResourceName for testing
        window.GetParentResourceName = () => 'ox_target';

        const optionsWrapper = document.getElementById("options-wrapper");
        const body = document.body;
        const eye = document.getElementById("eyeSvg");

        let isVisible = false;

        // Create left and right containers
        function createSideContainers() {
            optionsWrapper.innerHTML = '';
            
            const leftContainer = document.createElement('div');
            leftContainer.id = 'options-left';
            leftContainer.className = 'options-side-container side-left';
            
            const rightContainer = document.createElement('div');
            rightContainer.id = 'options-right';
            rightContainer.className = 'options-side-container side-right';
            
            optionsWrapper.appendChild(leftContainer);
            optionsWrapper.appendChild(rightContainer);
        }

        // Test data with clear left/right separation
        const testData = {
            options: {
                __global: [
                    // LEFT SIDE OPTIONS
                    {
                        icon: 'fa-solid fa-cog',
                        label: 'Settings',
                        hide: false,
                        side: 'left',
                        subMenu: [
                            {
                                icon: 'fa-solid fa-volume-up',
                                label: 'Audio Settings',
                                hide: false,
                                subMenu: [
                                    {
                                        icon: 'fa-solid fa-music',
                                        label: 'Music Volume',
                                        hide: false
                                    },
                                    {
                                        icon: 'fa-solid fa-microphone',
                                        label: 'Voice Volume',
                                        hide: false
                                    }
                                ]
                            },
                            {
                                icon: 'fa-solid fa-display',
                                label: 'Display Settings',
                                hide: false
                            },
                            {
                                icon: 'fa-solid fa-gamepad',
                                label: 'Controls',
                                hide: false
                            }
                        ]
                    },
                    // RIGHT SIDE OPTIONS
                    {
                        icon: 'fa-solid fa-hand',
                        label: 'Interact',
                        hide: false,
                        side: 'right'
                    },
                    {
                        icon: 'fa-solid fa-user',
                        label: 'Player Actions',
                        hide: false,
                        side: 'right',
                        subMenu: [
                            {
                                icon: 'fa-solid fa-id-card',
                                label: 'Show ID',
                                hide: false
                            },
                            {
                                icon: 'fa-solid fa-handshake',
                                label: 'Greet',
                                hide: false
                            },
                            {
                                icon: 'fa-solid fa-wave-square',
                                label: 'Wave',
                                hide: false
                            }
                        ]
                    }
                ],
                globalTarget: [
                    // LEFT SIDE
                    {
                        icon: 'fa-solid fa-car',
                        label: 'Vehicle Options',
                        hide: false,
                        side: 'left',
                        subMenu: [
                            {
                                icon: 'fa-solid fa-key',
                                label: 'Lock/Unlock',
                                hide: false
                            },
                            {
                                icon: 'fa-solid fa-gas-pump',
                                label: 'Refuel',
                                hide: false
                            },
                            {
                                icon: 'fa-solid fa-car-battery',
                                label: 'Engine',
                                hide: false,
                                subMenu: [
                                    {
                                        icon: 'fa-solid fa-play',
                                        label: 'Start Engine',
                                        hide: false
                                    },
                                    {
                                        icon: 'fa-solid fa-stop',
                                        label: 'Stop Engine',
                                        hide: false
                                    }
                                ]
                            }
                        ]
                    },
                    // RIGHT SIDE
                    {
                        icon: 'fa-solid fa-wrench',
                        label: 'Repair Vehicle',
                        hide: false,
                        side: 'right'
                    }
                ]
            },
            zones: [
                [
                    // LEFT SIDE
                    {
                        icon: 'fa-solid fa-shopping-cart',
                        label: 'Shop Menu',
                        hide: false,
                        side: 'left',
                        subMenu: [
                            {
                                icon: 'fa-solid fa-apple-alt',
                                label: 'Food',
                                hide: false,
                                subMenu: [
                                    {
                                        icon: 'fa-solid fa-hamburger',
                                        label: 'Fast Food',
                                        hide: false
                                    },
                                    {
                                        icon: 'fa-solid fa-carrot',
                                        label: 'Healthy Food',
                                        hide: false
                                    }
                                ]
                            },
                            {
                                icon: 'fa-solid fa-tshirt',
                                label: 'Clothing',
                                hide: false
                            }
                        ]
                    },
                    // RIGHT SIDE
                    {
                        icon: 'fa-solid fa-door-open',
                        label: 'Enter Building',
                        hide: false,
                        side: 'right'
                    }
                ]
            ]
        };

        function showTarget() {
            if (isVisible) return;
            
            isVisible = true;
            body.style.visibility = 'visible';
            eye.classList.add("eye-hover");
            createSideContainers();
            closeCurrentSubmenu();
            
            // Create test options
            for (const type in testData.options) {
                testData.options[type].forEach((data, id) => {
                    const side = data.side || 'right';
                    createOptions(type, data, id + 1, null, side);
                });
            }
            
            if (testData.zones) {
                for (let i = 0; i < testData.zones.length; i++) {
                    testData.zones[i].forEach((data, id) => {
                        const side = data.side || 'right';
                        createOptions("zones", data, id + 1, i + 1, side);
                    });
                }
            }
        }

        function hideTarget() {
            if (!isVisible) return;
            
            isVisible = false;
            body.style.visibility = 'hidden';
            eye.classList.remove("eye-hover");
            closeCurrentSubmenu();
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (e.key === 'e' || e.key === 'E') {
                if (isVisible) {
                    hideTarget();
                } else {
                    showTarget();
                }
            }
        });

        // Test control functions
        window.addLeftOption = function() {
            const newOption = {
                icon: 'fa-solid fa-star',
                label: 'New Left Option',
                hide: false,
                side: 'left',
                subMenu: [
                    {
                        icon: 'fa-solid fa-rocket',
                        label: 'Launch',
                        hide: false
                    }
                ]
            };
            
            testData.options.__global.push(newOption);
            
            if (isVisible) {
                showTarget();
            }
        };

        window.addRightOption = function() {
            const newOption = {
                icon: 'fa-solid fa-heart',
                label: 'New Right Option',
                hide: false,
                side: 'right'
            };
            
            testData.options.__global.push(newOption);
            
            if (isVisible) {
                showTarget();
            }
        };

        window.clearOptions = function() {
            hideTarget();
            testData.options.__global = [];
            testData.options.globalTarget = [];
            testData.zones = [];
        };

        let complexMenuEnabled = false;
        window.toggleComplexMenu = function() {
            complexMenuEnabled = !complexMenuEnabled;
            
            if (complexMenuEnabled) {
                // Add complex nested menu
                testData.options.__global.push({
                    icon: 'fa-solid fa-layer-group',
                    label: 'Complex Menu',
                    hide: false,
                    side: 'left',
                    subMenu: [
                        {
                            icon: 'fa-solid fa-folder',
                            label: 'Level 1A',
                            hide: false,
                            subMenu: [
                                {
                                    icon: 'fa-solid fa-file',
                                    label: 'Level 2A',
                                    hide: false
                                },
                                {
                                    icon: 'fa-solid fa-file',
                                    label: 'Level 2B',
                                    hide: false
                                }
                            ]
                        },
                        {
                            icon: 'fa-solid fa-folder',
                            label: 'Level 1B',
                            hide: false
                        }
                    ]
                });
            } else {
                // Remove complex menu
                testData.options.__global = testData.options.__global.filter(
                    option => option.label !== 'Complex Menu'
                );
            }
            
            if (isVisible) {
                showTarget();
            }
        };

        // Initialize
        body.style.visibility = 'hidden';
    </script>
</body>
</html>